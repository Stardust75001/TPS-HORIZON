{% comment %}
Auto-generated by ChatGPT ‚Äì theme.liquid avec compatibilit√© tooltip, ATC & IndexNow support
{% endcomment %}

{% if request.path == '/nzsn5xvamw9bjgtyx6egp9rnhwz2vp1t.txt' %}
  nzsn5xvamw9bjgtyx6egp9rnhwz2vp1t
  {% render 'theme-blank-exit' %}
{% endif %}

<!doctype html>
<html class="{% if settings.animations_on_scroll %}scroll-on-animations{% endif %}" 
      {% if settings.browser_tab_enable %}data-inactive-tab-text="{{ settings.browser_tab_text }}"{% endif %} 
      lang="{{ request.locale.iso_code }}">
<head>
  {% comment %} HEAD de la boutique Shopify ‚Äì m√©tas, SEO, GTM, Ahrefs {% endcomment %}

  <!-- Google Tag Manager -->
  <script defer src="https://www.googletagmanager.com/gtm.js?id=GTM-5WN7CP9V"></script>

  <!-- Ahrefs Web Analytics -->
  <script src="https://analytics.ahrefs.com/analytics.js" data-key="fuFwCS0rf6Z8X3Lv30s+Fg" async></script>

  <!-- üîß Correction des doubles slashs dans les liens -->
  <script defer>
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('a[href*="//"]').forEach(link => {
        const href = link.getAttribute('href');
        if (href.startsWith('/') && href.includes('//')) {
          link.setAttribute('href', href.replace(/\/{2,}/g, '/'));
        }
      });
    });
  </script>

  <!-- Meta et favicon -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="{{ settings.color_primary }}">
  <link rel="canonical" href="{{ canonical_url }}">
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
  <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
  {% unless settings.favicon == blank %}
    <link rel="icon" type="image/png" sizes="32x32" href="{{ settings.favicon | image_url }}">
  {% endunless %}

  <title>
    {{ page_title }}{% if current_tags %} ‚Äì {{ current_tags | join: ', ' }}{% endif %}{% if current_page != 1 %} ‚Äì Page {{ current_page }}{% endif %}
  </title>

  {% if page_description %}
    <meta name="description" content="{{ page_description | escape }}">
  {% endif %}

  {% render 'meta-tags' %}
  {{ content_for_header }}
  <meta name="sentry-release" content="shop-theme-{{ env.VERSION }}">

  <!-- Styles -->
  <link href="{{ 'base.css' | asset_url }}" rel="stylesheet">
  <link href="{{ 'custom-style.css' | asset_url }}" rel="stylesheet">
  <link href="{{ 'vendor-bootstrap.min.css' | asset_url }}" rel="stylesheet">
</head>

<!-- Polyfill optional chaining -->
<script defer>
  (function() {
    if (typeof Object.prototype?.__optionalChain__ !== 'function') {
      Object.defineProperty(Object.prototype, '__optionalChain__', {
        value: function(obj, prop) {
          return obj == null ? undefined : obj[prop];
        },
        configurable: true,
        enumerable: false
      });
    }
  })();
</script>

<!-- Scripts -->
<script src="{{ 'vendor-bootstrap.bundle.min.js' | asset_url }}" defer></script>
<script src="{{ 'utils.js' | asset_url }}" defer></script>
<script src="{{ 'custom-elements.js' | asset_url }}" defer></script>
<script src="{{ 'collection.js' | asset_url }}" defer></script>
<script src="{{ 'base.js' | asset_url }}" defer></script>
<script src="{{ 'custom.js' | asset_url }}" defer></script>

<!-- Shopify Web Pixels fallback -->
<script defer>
  document.addEventListener("DOMContentLoaded", function () {
    try {
      if (window.webPixelsManager?.init instanceof Function) {
        const api = window.webPixelsManager.init({}) || undefined;
        if (api) {
          window.webPixelsManagerAPI = api;
        }
      }
      function publishEvent(eventName, payload = {}) {
        if (window.webPixelsManagerAPI?.publishCustomEvent instanceof Function) {
          window.webPixelsManagerAPI.publishCustomEvent(eventName, payload);
        } else {
          window.webPixelsEventQueue = window.webPixelsEventQueue || [];
          window.webPixelsEventQueue.push({ eventName, payload });
        }
      }
      const checkoutBtn = document.querySelector('[name="checkout"], .checkout-button');
      if (checkoutBtn) {
        checkoutBtn.addEventListener("click", function () {
          publishEvent("checkout_started");
        });
      }
      const searchForm = document.querySelector('form[action="/search"]');
      if (searchForm) {
        searchForm.addEventListener("submit", function () {
          const searchInput = searchForm.querySelector('input[name="q"]');
          publishEvent("search_submitted", {
            search_term: searchInput ? searchInput.value : ""
          });
        });
      }
      publishEvent("page_viewed", {});
    } catch (e) {
      console.error("Erreur Web Pixels :", e);
    }
  });
</script>

<!-- Sentry SDK -->
<script defer src="https://browser.sentry-cdn.com/7.92.0/bundle.tracing.min.js" crossorigin="anonymous"></script>
<script defer>
  document.addEventListener("DOMContentLoaded", function () {
    if (window.Sentry) {
      Sentry.init({
        dsn: 'https://011a0ff43ae59d78bdad9dc3dd9b6bb9@o4509330673303552.ingest.de.sentry.io/4509330707972176',
        integrations: [new Sentry.BrowserTracing()],
        tracesSampleRate: 1.0,
        debug: false,
        allowUrls: [/thepetsociety\.paris/],
        release: "shop-theme-{{ env.VERSION }}",
        beforeSend(event, hint) {
          const error = hint?.originalException;
          if (error && error.message?.includes("Test de v√©rification manuelle Sentry")) {
            return null;
          }
          return event;
        }
      });
      Sentry.setTag("shop_locale", "{{ request.locale.iso_code }}");
      Sentry.setTag("theme_handle", "{{ theme.handle }}");
      Sentry.setTag("page_type", "{{ request.page_type }}");
      {% if customer %}
      Sentry.setUser({
        id: "{{ customer.id }}",
        email: "{{ customer.email }}",
        username: "{{ customer.first_name | append: ' ' | append: customer.last_name }}"
      });
      {% endif %}
    }
  });
</script>

<body class="{{ request.page_type | prepend: 'page-type-' }}">
  <a class="visually-hidden-focusable" href="#main">{{ 'general.accessibility.skip_content' | t }}</a>
  <privacy-banner-element></privacy-banner-element>

  {% if template == 'cart' %}
    {% comment %} Section 'cart' d√©sactiv√©e temporairement car manquante {% endcomment %}
    {%- comment -%} {% section 'cart' %} {%- endcomment -%}
  {% endif %}

  <div class="header-sticky-group">
    {% section 'announcement-bar' %}
    {% render 'social-icons' %}
    {% section 'discount-bar' %}
    {% section 'navbar' %}
    {% section 'stories-bar-sticky-dynamic' %}
  </div>

  <main id="main">{{ content_for_layout }}</main>
  {% section 'footer-group' %}

  {% unless settings.cart_drawer_disable %}
    {% unless request.page_type == 'cart' %}
      {% liquid assign shipping_enabled = settings.cart_shipping_protect_show %}
      {% if settings.cart_drawer_show_shipping_rates %}
        {% render 'cart-shipping-rates-modal' %}
      {% endif %}
      {% if shipping_enabled %}
        {% assign shipping_protect_item = settings.cart_shipping_protect_product %}
      {% endif %}
      {% render 'offcanvas-cart' %}
    {% endunless %}
  {% endunless %}

  <script defer>
    document.addEventListener("DOMContentLoaded", function () {
      const langLinks = document.querySelectorAll('.language-selector-right a');
      langLinks.forEach(link => {
        link.addEventListener('click', function (e) {
          e.preventDefault();
          const href = this.getAttribute('href');
          const targetLang = href === '/' ? '' : href.replace('/', '');
          let currentPath = window.location.pathname;
          currentPath = currentPath.replace(/^\/(fr|de)(\/|$)/, '/');
          const newPath = targetLang ? `/${targetLang}${currentPath}` : currentPath;
          window.location.href = newPath;
        });
      });
    });
  </script>
  <script src="{{ 'stories-tooltips.js' | asset_url }}" defer></script>
  <script src="{{ 'product-options.js' | asset_url }}" defer></script>

  {% if content_for_header contains 'X-Shopify-Stage' %}
    <div style="font-size: 12px; text-align: center; color: gray; padding: 10px 0;">
      üîÅ Version actuelle : <strong>shop-theme-{{ env.VERSION }}</strong>
    </div>
  {% endif %}

  <!-- Google Tag Manager (noscript) -->
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5WN7CP9V" height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript>
</body>
</html>